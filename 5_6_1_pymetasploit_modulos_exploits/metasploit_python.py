from pymetasploit3.msfrpc import MsfRpcClient

def connect_metasploit():
    """Establece una conexión con el servidor de Metasploit.

    Returns:
        MsfRpcClient: Cliente conectado al servidor de Metasploit.

    """
    client = MsfRpcClient("password", ssl=True)  # Configura el cliente con SSL habilitado.
    print("Conectado a Metasploit!")
    return client

def search_exploits(client, keyword):
    """Busca exploits en el servidor de Metasploit basándose en una palabra clave.

    Args:
        client (MsfRpcClient): Cliente conectado al servidor de Metasploit.
        keyword (str): Palabra clave para buscar exploits relacionados.

    """
    exploits = client.modules.exploits  # Obtener la lista de exploits disponibles.
    # Filtra exploits que contengan la palabra clave en su nombre.
    filtered_exploits = [exploit for exploit in exploits if keyword.lower() in exploit.lower()]
    print(f"Exploits que contienen '{keyword}':")
    for exploit in filtered_exploits:
        print(exploit)  # Imprime cada exploit filtrado.

def main():
    """Función principal que ejecuta el script."""
    client = connect_metasploit()  # Establece la conexión con el servidor.
    keyword = input("Introduce la palabra clave por la que buscar exploits: ")
    search_exploits(client, keyword)  # Realiza la búsqueda de exploits.

if __name__ == "__main__":
    main()